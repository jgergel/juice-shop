pipeline {
	agent any
	stages {
		stage('Build'){
			steps {
				nodejs('nodjs_9_11_1_auto') {
					sh 'npm install --production'
				}
			}		
      	}
		stage('Policy Evaluation Dev'){
			steps {
				nexusPolicyEvaluation failBuildOnNetworkError: false, iqApplication: 'juiceshop', iqScanPatterns: [[scanPattern: 'node_modules/**/*']], iqStage: 'release', jobCredentialsId: ''
			}
		}
		stage('Publish/Deploy to Dev Repo'){
			steps {
				nodejs('nodjs_9_11_1_auto') {
					sh 'npm publish'
				}
			}
		}
	}
}
